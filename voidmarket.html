<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VoidMarket ‚Äì Collectibles & Digital Art</title>
  <link rel="stylesheet" href="style.css" />

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    /* ----------------------------------------
      RETRO VOIDMARKET THEME (GAME PAGE ONLY)
      ---------------------------------------- */

    body.vm-game{
      /* Overstyr fargene her i stedet for i :root */
      --bg: #05060a;
      --panel: #050814;
      --card: #050711;
      --text: #e5ecff;
      --muted: #9ca3af;
      --accent: #a855f7;
      --primary: #22c55e;
      --danger: #f97373;
      --ring: #3b4255;
      --radius: 6px;
      --shadow: 0 0 0 1px #000, 0 18px 40px rgba(0,0,0,.9);

      margin: 0;
      background:
        radial-gradient(circle at top, #151826 0%, #05060a 55%),
        repeating-linear-gradient(
          0deg,
          #05060a 0px,
          #05060a 1px,
          #040712 1px,
          #040712 2px
        );
      color: var(--text);
      font-family: "Verdana", system-ui, sans-serif;
      font-size: 14px;
    }

    /* Litt CRT-feel / scanlines, men uten √• blokkere klikk */
    body.vm-game::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      opacity:0.13;
      mix-blend-mode:soft-light;
      background:
        repeating-linear-gradient(
          to bottom,
          rgba(255,255,255,0.12) 0px,
          rgba(255,255,255,0.12) 1px,
          transparent 1px,
          transparent 3px
        );
      z-index:0;
    }

    /* MAIN LAYOUT */
    body.vm-game .vm-header,
    body.vm-game .vm-tabs,
    body.vm-game main,
    body.vm-game .vm-footer{
      position:relative;
      z-index:1; /* over scanline-overlay */
    }

    body.vm-game .vm-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      max-width:1120px;
      margin:12px auto 0;
      padding:8px 12px;
      background:linear-gradient(90deg, #0b1020, #171f3c);
      border:2px solid #3b4457;
      border-bottom:none;
      box-shadow:0 0 0 1px #000, 0 14px 26px rgba(0,0,0,.9);
    }

    body.vm-game .brand{
      display:flex;
      gap:10px;
      align-items:center;
    }

    body.vm-game .logo{
      width:38px;
      height:38px;
      border-radius:4px;
      border:1px solid #000;
      background:#000;
      image-rendering:pixelated;
    }

    body.vm-game .brand h1{
      font-size:15px;
      margin:0 0 2px;
      letter-spacing:0.16em;
      text-transform:uppercase;
    }

    body.vm-game .brand .tag{
      margin:0;
      font-size:11px;
      color:var(--muted);
    }

    body.vm-game .wallet{
      display:flex;
      gap:8px;
      align-items:center;
      font-size:11px;
    }

    body.vm-game .coins{
      display:flex;
      gap:6px;
      align-items:center;
      padding:6px 10px;
      border-radius:999px;
      background:#020308;
      border:1px solid #4b5563;
      box-shadow:inset 0 0 0 1px #000;
    }

    body.vm-game .coins strong{
      font-size:12px;
    }

    body.vm-game .coins small{
      color:var(--muted);
    }

    /* Tabs = gammel nett-portal/launcher */
    body.vm-game .vm-tabs{
      max-width:1120px;
      margin:0 auto;
      padding:4px 10px 0;
      background:#020308;
      border-left:2px solid #3b4457;
      border-right:2px solid #3b4457;
      border-top:2px solid #3b4457;
      box-shadow:0 0 0 1px #000;
      display:flex;
      gap:6px;
    }

    body.vm-game .vm-tabs .tab{
      padding:6px 10px;
      border-radius:0;
      border:1px solid #4b5563;
      background:linear-gradient(180deg,#111827,#020617);
      color:var(--text);
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:0.12em;
      cursor:pointer;
    }

    body.vm-game .vm-tabs .tab.active{
      background:linear-gradient(180deg,#22c55e,#14532d);
      border-color:#16a34a;
      color:#f9fafb;
      box-shadow:0 0 0 1px #000;
    }

    /* Hoved ‚Äúwindow‚Äù */
    body.vm-game main{
      max-width:1120px;
      margin:0 auto 18px;
      padding:12px 14px 18px;
      background:radial-gradient(circle at top,#151927 0%,#05060a 70%);
      border:2px solid #3b4457;
      border-top:none;
      box-shadow:0 0 0 1px #000, 0 22px 50px rgba(0,0,0,.9);
    }

    body.vm-game h2{
      font-size:15px;
      margin:0 0 6px;
      letter-spacing:0.12em;
      text-transform:uppercase;
    }

    body.vm-game .muted{
      color:var(--muted);
    }

    /* Cards i market */
    body.vm-game .cards{
      display:grid;
      gap:12px;
      grid-template-columns:repeat(auto-fit, minmax(260px, 1fr));
    }

    body.vm-game .card{
      background:#040713;
      border-radius:4px;
      border:1px solid #4b5563;
      box-shadow:inset 0 0 0 1px #020308;
      overflow:hidden;
    }

    body.vm-game .card-media{
      height:130px;
      background-size:contain;
      background-position:center;
      background-repeat:no-repeat;
      background-color:#020308;
      border-bottom:1px solid #111827;
    }

    body.vm-game .card-body{
      padding:10px 12px;
    }

    body.vm-game .card-body h2{
      font-size:13px;
      margin:0 0 4px;
      letter-spacing:0.08em;
    }

    body.vm-game .card-body p{
      margin:0 0 8px;
      font-size:12px;
    }

    body.vm-game .meta{
      font-size:11px;
      color:var(--muted);
    }

    body.vm-game .card-actions{
      padding:8px 10px;
      border-top:1px solid #111827;
      display:flex;
      justify-content:flex-end;
      gap:6px;
      background:#020308;
    }

    /* Inventory / filter bar */
    body.vm-game .inv-toolbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:10px;
      padding:8px 10px;
      background:#020308;
      border:1px solid #3b4457;
    }

    body.vm-game .filter label,
    body.vm-game .search label{
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:0.16em;
      color:var(--muted);
    }

    body.vm-game .filter select,
    body.vm-game .search input{
      background:#050814;
      border:1px solid #4b5563;
      color:var(--text);
      padding:4px 6px;
      border-radius:2px;
      font-size:12px;
    }

    /* Achievements */
    body.vm-game .ach-wrap{
      padding:8px 6px 2px;
      border:1px solid #3b4457;
      background:#020308;
    }

    body.vm-game .ach-list{
      margin-top:8px;
    }

    body.vm-game .ach-item{
      display:flex;
      gap:10px;
      align-items:center;
      padding:6px 8px;
      background:#050714;
      border:1px solid #374151;
      border-radius:2px;
    }

    body.vm-game .ach-item.locked{
      opacity:.55;
      border-style:dashed;
    }

    /* Profile cards */
    body.vm-game .profile-grid{
      display:grid;
      gap:12px;
      grid-template-columns:repeat(auto-fit, minmax(260px,1fr));
    }

    body.vm-game .profile-card{
      background:#040713;
      border:1px solid #4b5563;
      border-radius:4px;
      padding:10px 12px;
      box-shadow:inset 0 0 0 1px #020308;
    }

    body.vm-game .profile-card h3{
      margin:0 0 6px;
      font-size:13px;
      letter-spacing:0.1em;
      text-transform:uppercase;
    }

    body.vm-game .profile-card p{
      margin:2px 0;
      font-size:12px;
    }

    body.vm-game .profile-actions{
      margin-top:8px;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }

    /* Trading */
    body.vm-game .trading-grid{
      display:grid;
      grid-template-columns:minmax(0,1.3fr) minmax(0,1fr);
      gap:12px;
    }

    @media (max-width:900px){
      body.vm-game .trading-grid{
        grid-template-columns:minmax(0,1fr);
      }
    }

    body.vm-game .trading-card{
      background:#040713;
      border-radius:4px;
      padding:10px 12px;
      border:1px solid #4b5563;
    }

    body.vm-game .social-subheading{
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:0.16em;
      color:var(--muted);
      margin:8px 0 4px;
    }

    /* Global chat = liten gammel chat-boks */
    body.vm-game .global-chat{
      position:fixed;
      left:10px;
      bottom:14px;
      width:320px;
      max-height:260px;
      display:flex;
      flex-direction:column;
      background:#020308;
      border:2px solid #3b4457;
      box-shadow:0 0 0 1px #000, 0 12px 24px rgba(0,0,0,.95);
      border-radius:4px;
      font-size:11px;
      z-index:40;
      transition:transform .15s ease-out, opacity .15s ease-out, max-height .15s ease-out;
    }

    body.vm-game .global-chat-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:6px;
      padding:4px 6px;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:0.16em;
      color:var(--muted);
      border-bottom:1px solid #111827;
      background:linear-gradient(90deg,#0b1020,#111827);
      cursor:move; /* drag-handle p√• desktop */
    }

    body.vm-game .global-chat-title{
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    body.vm-game .global-chat-toggle{
      border:1px solid #4b5563;
      background:#020308;
      color:var(--muted);
      font-size:10px;
      padding:2px 6px;
      border-radius:2px;
      text-transform:uppercase;
      letter-spacing:0.16em;
      cursor:pointer;
    }

    body.vm-game .global-chat-list{
      list-style:none;
      margin:0;
      padding:6px 8px 8px;
      overflow-y:auto;
      flex:1 1 auto;
    }

    /* N√•r den er "collapsed": bare topplinja vises */
    body.vm-game .global-chat.collapsed{
      max-height:26px;
    }

    body.vm-game .global-chat.collapsed .global-chat-list{
      display:none;
    }

    /* Mobil: vinduet er fast nede, full bredde, ikke draggable */
    @media (max-width:720px){
      body.vm-game .global-chat{
        left:0;
        right:0;
        bottom:0;
        width:auto;
        max-width:none;
        border-radius:0;
        border-left:0;
        border-right:0;
      }

      body.vm-game .global-chat-header{
        cursor:default; /* ingen "drag"-cursor p√• mobil */
      }
    }

    /* Buttons ‚Äì litt mer kantete/old */
    body.vm-game .btn{
      border-radius:2px;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:0.12em;
      padding:6px 10px;
      border:1px solid #4b5563;
      background:linear-gradient(180deg,#111827,#020617);
      color:var(--text);
    }

    body.vm-game .btn.primary{
      background:linear-gradient(180deg,#22c55e,#14532d);
      border-color:#16a34a;
    }

    body.vm-game .btn.accent{
      background:linear-gradient(180deg,#4f46e5,#312e81);
      border-color:#4f46e5;
    }

    body.vm-game .btn-ghost{
      border-radius:2px;
      border:1px solid #4b5563;
      background:#020308;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:0.12em;
    }

    /* Footer som gammel ‚Äústatus bar‚Äù */
    body.vm-game .vm-footer{
      max-width:1120px;
      margin:0 auto 10px;
      padding:4px 10px;
      background:#020308;
      border:2px solid #3b4457;
      border-top:none;
      box-shadow:0 0 0 1px #000;
      font-size:10px;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    body.vm-game .vm-footer small::after{
      content:"  ¬∑  build vm-client-0.92b";
      opacity:0.7;
    }

    @media (max-width:720px){
      body.vm-game .vm-header,
      body.vm-game .vm-tabs,
      body.vm-game main,
      body.vm-game .vm-footer{
        margin-inline:8px;
      }

      body.vm-game .trading-grid{
        grid-template-columns:minmax(0,1fr);
      }

      body.vm-game .global-chat{
        display:none; /* skjul global chat p√• veldig sm√• skjermer */
      }
    }

    /* PROFILE LAYOUT ‚Äì old web dashboard */

    .profile-titles{
      grid-area: titles;
    }

    body.vm-game .profile-grid{
      display:grid;
      gap:16px;
      /* 3 kolonner p√• store skjermer */
      grid-template-columns: 2fr 2fr 1.6fr;
      grid-template-areas:
        "overview   overview   social"
        "collection featured   social"
        "titles     titles     social"
        "account    account    social";
      align-items:flex-start;
    }

    /* Knytter hvert kort til et omr√•de */
    body.vm-game .profile-overview{  grid-area: overview; }
    body.vm-game .profile-collection{grid-area: collection; }
    body.vm-game .profile-featured{ grid-area: featured; }
    body.vm-game .profile-social{   grid-area: social; }
    body.vm-game .profile-account{  grid-area: account; }

    /* Litt justeringer for at kortene skal f√∏les mer ‚Äúgamle‚Äù */
    body.vm-game .profile-card h3{
      letter-spacing:0.18em;
      font-size:12px;
      text-transform:uppercase;
      margin-bottom:6px;
    }

    body.vm-game .profile-card{
      padding:14px 16px;
    }

    /* Mobil / sm√• skjermer ‚Äì bare stack alt */
    @media (max-width: 900px){
      body.vm-game .profile-grid{
        grid-template-columns:minmax(0,1fr);
        grid-template-areas:
          "overview"
          "collection"
          "featured"
          "social"
          "account";
      }
    }

  </style>


  <script>
  (function guardAuth(){
    try {
      const sess = JSON.parse(localStorage.getItem("vm_session_v1"));
      if (!sess || !sess.username) {
        // not logged in -> replace history entry so back won't return
        location.replace("index.html");
        return;
      }
      // Handle bfcache restore (user pressed Back)
      window.addEventListener("pageshow", function (e) {
        if (e.persisted) {
          const s = JSON.parse(localStorage.getItem("vm_session_v1") || "null");
          if (!s || !s.username) location.replace("index.html");
        }
      });
    } catch {
      location.replace("index.html");
    }
  })();
  
</script>

</head>
<body class="vm-game">
  <header class="vm-header">
    <div class="brand">
      <img src="assets/boxes/beta/bta-sko.png" class="logo" alt="">
      <div>
        <h1>VoidMarket BETA</h1>
        <p class="tag">Open boxes, collect art ‚Äì all free.</p>
      </div>
    </div>

    <div class="wallet">
      <div class="profile">
        <button id="profileBtn" class="profile-btn">
          <span class="avatar">üë§</span>
          <span class="profile-name-wrap">
            <span id="profileName">Guest</span>
            <span id="profileTitleChip" class="profile-title-chip"></span>
          </span>
        </button>
      </div>
      <div class="coins" title="Your coins">
        <strong id="coinCount">0</strong>
        <span>Credit</span>
      </div>
    </div>

  </header>

  <nav class="vm-tabs" role="tablist" aria-label="Navigation">
    <button class="tab active" data-tab="market">Market</button>
    <button class="tab" data-tab="inventory">Inventory</button>
    <button class="tab" data-tab="trading">Trading</button>
    <button class="tab" data-tab="profile">Profile</button>
    <button class="tab" data-tab="info">Info</button>
    <button class="tab" data-tab="achievements">Progress</button>
  </nav>

  <main>
    <!-- MARKET -->
    <section id="market" class="tabpanel active" aria-labelledby="market-tab">
      
      
      <div id="marketCards" class="cards"></div>

    </section>

    <!-- INVENTORY -->
    <section id="inventory" class="tabpanel" aria-labelledby="inventory-tab">
      <div class="inv-toolbar">
        <div class="filter">
          <label for="rarityFilter">Filter:</label>
          <select id="rarityFilter">
            <option value="ALL">All</option>
            <option value="COMMON">Common</option>
            <option value="RARE">Rare</option>
            <option value="EPIC">Epic</option>
            <option value="LEGENDARY">Legendary</option>
            <option value="MYTHIC">Mythic</option>
          </select>
        </div>
      </div>

      <div class="search">
        <label for="invSearch">Search:</label>
        <input id="invSearch" type="text" placeholder="Name, set or description..." />
      </div>

      <div id="inventoryGrid" class="grid"></div>
      <p id="emptyInv" class="muted">No items yet ‚Äì open a box in the Market!</p>
    </section>

    <!-- TRADING -->
    <section id="trading" class="tabpanel" aria-labelledby="trading-tab">
      <div class="trading-page">
        <h2>Trading</h2>
        <p class="muted">Manage your open trades and view your trade history.</p>

        <div class="trading-grid">
          <div class="trading-card">
            <h3>Open trades</h3>
            <p class="muted small">Incoming and outgoing trades that are still pending.</p>

            <h4 class="social-subheading">Incoming</h4>
            <ul id="openTradesIncoming" class="trades-list"></ul>

            <h4 class="social-subheading">Outgoing</h4>
            <ul id="openTradesOutgoing" class="trades-list"></ul>
          </div>

          <div class="trading-card">
            <h3>History</h3>
            <p class="muted small">Previously accepted or declined trades.</p>
            <ul id="tradeHistoryList" class="trades-list"></ul>
          </div>
        </div>
      </div>
    </section>

    <!-- PROGRESS: Achievements + Titles -->
    <section id="achievements" class="tabpanel" aria-labelledby="achievements-tab">
      <div class="ach-wrap">
        <div class="ach-header-row">
          <h2>Progress</h2>

          <div class="ach-view-toggle">
            <button type="button" class="ach-view-btn active" data-view="achievements">
              Achievements <span id="achCounter" class="ach-counter"></span>
            </button>
            <button type="button" class="ach-view-btn" data-view="titles">
              Titles <span id="titleCounter" class="ach-counter"></span>
            </button>
          </div>
        </div>

        <p class="muted small">
          Track your progress through VoidMarket. Achievements unlock new titles you can equip on your profile.
        </p>

        <!-- Achievements list -->
        <div id="achievementsView">
          <div id="achList" class="ach-list"></div>
        </div>

        <!-- Titles list -->
        <div id="titlesView" hidden>
          <div id="titleList" class="title-list"></div>
        </div>
      </div>
    </section>

    <!-- PROFILE -->
    <section id="profile" class="tabpanel" aria-labelledby="profile-tab">
      <div class="profile-page">
        <h2>Profile</h2>
        <p class="muted">Online profile and save data for your VoidMarket account.</p>

        <div class="profile-grid">
          <!-- Overview ‚Äì topp til venstre, bred -->
          <div class="profile-card profile-overview">
            <h3>Overview</h3>
            <p><strong>Username:</strong> <span id="profileUsername">-</span></p>
            <p><strong>Created:</strong> <span id="profileCreatedAt">-</span></p>
            <p><strong>Coins:</strong> <span id="profileCoins">0</span> Credit</p>
          </div>

          <!-- Collection ‚Äì under overview, venstre kolonne -->
          <div class="profile-card profile-collection">
            <h3>Collection</h3>
            <p><strong>Total items:</strong> <span id="profileItemsTotal">0</span></p>
            <p><strong>Unopened boxes:</strong> <span id="profileBoxesTotal">0</span></p>
            <p><strong>Collectibles:</strong> <span id="profileCollectiblesTotal">0</span></p>
            <p><strong>Achievements unlocked:</strong> <span id="profileAchCount">0</span></p>
          </div>

          <!-- TITLES -->
          <div class="profile-card profile-titles">
            <h3>Title</h3>
            <p class="muted small">
              Equip a title to show next to your name. View all titles in the Progress tab.
            </p>

            <p class="title-current">
              <strong>Current title:</strong>
              <span id="currentTitleLabel">No title equipped</span>
            </p>

            <label class="muted small" for="titleSelect">Change title</label>
            <select id="titleSelect"></select>

            <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
              <button id="clearTitleBtn" class="btn small ghost" type="button">Clear title</button>
            </div>

            <p class="tiny" style="margin-top:8px;">
              Unlock more titles by completing achievements and collecting items.
            </p>
          </div>

          <!-- Featured items ‚Äì midtkolonnen -->
          <div class="profile-card profile-featured">
            <h3>Featured items</h3>
            <p class="muted small">Up to 3 items shown on your public profile.</p>
            <div class="profile-feature-grid">
              <div class="profile-feature-slot" id="profileSlot1"></div>
              <div class="profile-feature-slot" id="profileSlot2"></div>
              <div class="profile-feature-slot" id="profileSlot3"></div>
            </div>
          </div>

          <!-- Social ‚Äì fast kolonne helt til h√∏yre -->
          <div class="profile-card profile-social">
            <h3>Social</h3>

            <div class="social-add">
              <input id="friendSearchInput" type="text" autocomplete="off" placeholder="Friend's username..." />
              <button id="addFriendBtn" class="btn small">Add friend</button>
              <button id="viewProfileBtn" class="btn small ghost">View profile</button>
            </div>

            <p id="socialMessage" class="muted small"></p>

            <h4 class="social-subheading">Your friends</h4>
            <ul id="friendsList" class="friends-list"></ul>

            <button id="openTradingTabBtn" class="btn small ghost" style="margin-top:8px;">
              Open trading
            </button>
          </div>

          <!-- Account ‚Äì bred rad nederst -->
          <div class="profile-card profile-account profile-danger">
            <h3>Account</h3>
            <p class="muted">Log out of this device, or request deletion of your user data.</p>
            <div class="profile-actions">
              <button id="logoutBtn" class="btn ghost">Log out</button>
              <button id="deleteUserBtn" class="btn danger">Delete user &amp; save</button>
            </div>
          </div>
        </div>

        </div>
      </div>
    </section>

    <!-- ITEM MODAL -->
    <div id="itemModal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Item details">
      <div class="modal-card">
        <button id="itemModalClose" class="modal-close" aria-label="Close">‚úï</button>
        <div class="modal-body">
          <img id="modalImg" src="" alt="" class="modal-img" />
          <div class="modal-info">
            <h3 id="modalName">Item name</h3>
            <div class="modal-meta">
              <span id="modalRarity" class="pill">RARITY</span>
              <span id="modalCount" class="pill">x1</span>
            </div>
            <p id="modalDesc" class="muted">Description...</p>
            <div class="value-row">
              <span>Value (each):</span>
              <strong id="modalValue">0</strong> Credit
            </div>
            <div class="modal-actions">
              <button id="openBoxBtn" class="btn primary" style="display:none">Open box</button> 
              <button id="sellOneBtn" class="btn">Sell 1</button>
            </div>
            <div class="modal-profile-actions">
              <span class="muted small">Show on profile:</span>
              <div class="profile-slot-buttons">
                <button class="btn ghost profile-slot-btn" data-slot="0">Slot 1</button>
                <button class="btn ghost profile-slot-btn" data-slot="1">Slot 2</button>
                <button class="btn ghost profile-slot-btn" data-slot="2">Slot 3</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


    <!-- PUBLIC PROFILE MODAL -->
    <div id="publicProfileModal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Player profile">
      <div class="modal-card">
        <button id="publicProfileClose" class="modal-close" aria-label="Close">‚úï</button>
        <div class="modal-body modal-profile-body">
          <!-- Venstre side: basic info -->
          <div class="modal-profile-main">
            <h3 id="publicProfileName">Username</h3>
            <p class="muted small">
              Title:
              <span id="publicProfileTitle">No title equipped</span>
            </p>
            <p class="muted small">
              Created:
              <span id="publicProfileCreated">Unknown</span>
            </p>
          </div>

          <!-- H√∏yre side: featured items -->
          <div class="modal-profile-featured">
            <h4>Featured items</h4>
            <p class="muted small" id="publicProfileNoFeatured">
              This player has no featured items yet.
            </p>
            <div id="publicProfileFeaturedGrid" class="profile-feature-grid"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- TRADE MODAL -->
    <div id="tradeModal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Trade">
      <div class="modal-card modal-wide">
        <button id="tradeModalClose" class="modal-close" aria-label="Close">‚úï</button>

        <div class="modal-body trade-modal-body">
          <div class="modal-info">
            <h3>Trade with <span id="tradeFriendName"></span></h3>
            <p class="muted small">
              Select which items you want to send. They‚Äôll leave your collection as soon as you send the trade.
            </p>

            <div id="tradeOfferList" class="trade-offer-list">
              <!-- Populeres fra script.js -->
            </div>

            <p id="tradeError" class="muted small"></p>

            <div class="trade-actions">
              <button id="tradeSendBtn" class="btn">Send trade</button>
              <button id="tradeCancelBtn" class="btn ghost">Cancel</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- INFO -->
    <section id="info" class="tabpanel" aria-labelledby="info-tab">
      <div class="info">

        <h3>EVENTS</h3>
        <ul>
          <li>To see active and upcoming events, join our <button id="discordBtn" class="discord-tab">Discord!</button></li>
          
        </ul>

      </div>
    </section>
  </main>

  <!-- GLOBAL overlays: show over any tab -->
  <div id="openingOverlay" class="opening hidden" aria-live="polite">
    <div class="opening-box">
      <img id="openingImg" src="" alt="Opening box" />
      <div class="opening-pulse"></div>
      <p class="opening-text">Opening...</p>
    </div>
  </div>

  <div id="revealArea" class="reveal hidden" aria-live="polite">
    <div class="sparkle"></div>
    <img id="revealImg" src="" alt="You received" />
    <div class="reveal-info">
      <h3 id="revealName">You got an item!</h3>
      <span id="revealTag" class="pill">RARITY</span>
      <button id="revealClose" class="btn ghost">Close</button>
    </div>
  </div>

  <footer class="vm-footer">
    <small>Built by collectors, for collectors</small>
  </footer>

  <div id="toast" class="toast" aria-live="polite"></div>


  <!-- GLOBAL CHAT -->
  <div id="globalChat" class="global-chat" aria-label="Global feed">
    <div class="global-chat-header">
      <span class="global-chat-title">Global feed</span>
      <button
        id="globalChatToggle"
        class="global-chat-toggle"
        type="button"
        aria-label="Toggle global chat"
      >
        ‚Äì
      </button>
    </div>
    <ul id="globalChatList" class="global-chat-list">
      <!-- messages -->
    </ul>
  </div>

  <script src="script.js"></script>
</body>
</html>
